<!DOCTYPE html><html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Registro de Viajes</title>
  <link rel="manifest" href="manifest.json">
  <style>
    body {
      font-family: Arial, sans-serif;
      padding: 10px;
      margin: 0;
    }label, select, input, button {
  margin: 5px 0;
  width: 100%;
  box-sizing: border-box;
  font-size: 16px;
}

button {
  padding: 10px;
}

.formulario {
  display: flex;
  flex-direction: column;
  gap: 10px;
}

.resumen {
  margin-top: 20px;
  font-size: 15px;
}

table {
  border-collapse: collapse;
  width: 100%;
  overflow-x: auto;
  display: block;
  font-size: 14px;
}

th, td {
  border: 1px solid #ddd;
  padding: 8px;
  text-align: center;
}

th {
  background-color: #f2f2f2;
}

.producto-premium { background-color: red; color: white; font-weight: bold; }
.producto-magna { background-color: green; color: white; font-weight: bold; }
.producto-diesel { background-color: black; color: white; font-weight: bold; }

.resumen .premium { color: red; font-weight: bold; }
.resumen .magna { color: green; font-weight: bold; }
.resumen .diesel {
  color: black;
  font-weight: bold;
  background-color: white;
  padding: 2px 4px;
  border-radius: 4px;
}

.turno-noche {
  background-color: #fff8b3;
  color: black;
  font-weight: bold;
}

.turno-dia {
  background-color: #2c3e50;
  color: white;
  font-weight: bold;
}

  </style>
</head>
<body>
  <h1>Registro de Viajes</h1>
  <p>Fecha actual: <span id="fechaActual"></span></p>  <div class="formulario">
    <label for="dia">Día:</label>
    <input type="number" id="dia" min="1" max="31"><label for="mes">Mes:</label>
<select id="mes">
  <option>Enero</option><option>Febrero</option><option>Marzo</option>
  <option>Abril</option><option>Mayo</option><option>Junio</option>
  <option>Julio</option><option>Agosto</option><option>Septiembre</option>
  <option>Octubre</option><option>Noviembre</option><option>Diciembre</option>
</select>

<label for="destino">Destino:</label>
<select id="destino">
  <option>Velam</option><option>San Juan de los Llanos</option><option>Noyowee</option>
  <option>Estación 0324</option><option>Bajos del Ejido</option><option>San Luis Acatlán</option>
</select>

<label for="producto">Producto:</label>
<select id="producto">
  <option>Premium</option><option>Magna</option><option>Diésel</option>
</select>

<label for="turno">Turno:</label>
<select id="turno">
  <option>Turno 1</option><option>Turno 2</option>
</select>

<button onclick="agregarViaje()">Agregar Viaje</button>

  </div>  <div class="resumen">
    <p>Total de viajes: <span id="totalViajes">0</span></p>
    <p><span class="premium">Premium: <span id="totalPremium">0</span></span> |
       <span class="magna">Magna: <span id="totalMagna">0</span></span> |
       <span class="diesel">Diésel: <span id="totalDiesel">0</span></span></p>
    <p>Velam: <span id="velam">0</span> |
       San Juan: <span id="sanjuan">0</span></p>
    <p>Noyowee: <span id="noyo">0</span> |
       0324: <span id="e0324">0</span></p>
    <p>Bajos: <span id="bajos">0</span> |
       SLA: <span id="sla">0</span></p>
    <p>Km totales: <span id="totalKm">0</span> km</p>
  </div>  <table id="tablaViajes">
    <thead>
      <tr><th>Día</th><th>Mes</th><th>Destino</th><th>Producto</th><th>Acciones</th></tr>
    </thead>
    <tbody></tbody>
  </table>  <script>
    const resumen = {
      total: 0,
      productos: { Premium: 0, Magna: 0, Diésel: 0 },
      destinos: {
        Velam: 0, "San Juan de los Llanos": 0, Noyowee: 0,
        "Estación 0324": 0, "Bajos del Ejido": 0, "San Luis Acatlán": 0
      }
    };

    const distanciasKm = {
      "Velam": 392,
      "San Juan de los Llanos": 410,
      "Noyowee": 405,
      "Estación 0324": 398,
      "Bajos del Ejido": 284,
      "San Luis Acatlán": 450
    };

    const viajes = JSON.parse(localStorage.getItem('viajes')) || [];

    function actualizarFecha() {
      const f = new Date();
      document.getElementById('fechaActual').textContent =
        f.getDate().toString().padStart(2, '0') + '/' +
        (f.getMonth() + 1).toString().padStart(2, '0') + '/' +
        f.getFullYear();
    }

    function guardarDatos() {
      localStorage.setItem('viajes', JSON.stringify(viajes));
    }

    function obtenerNumeroMes(nombreMes) {
      const meses = ["Enero", "Febrero", "Marzo", "Abril", "Mayo", "Junio",
                     "Julio", "Agosto", "Septiembre", "Octubre", "Noviembre", "Diciembre"];
      return meses.indexOf(nombreMes);
    }

    function actualizarResumen() {
      resumen.total = viajes.length;
      resumen.productos = { Premium: 0, Magna: 0, Diésel: 0 };
      for (let key in resumen.destinos) resumen.destinos[key] = 0;

      let totalKm = 0;
      viajes.forEach(v => {
        totalKm += distanciasKm[v.destino] || 0;
        resumen.productos[v.producto]++;
        resumen.destinos[v.destino]++;
      });

      document.getElementById('totalViajes').textContent = resumen.total;
      document.getElementById('totalPremium').textContent = resumen.productos.Premium;
      document.getElementById('totalMagna').textContent = resumen.productos.Magna;
      document.getElementById('totalDiesel').textContent = resumen.productos.Diésel;

      document.getElementById('velam').textContent = resumen.destinos.Velam;
      document.getElementById('sanjuan').textContent = resumen.destinos["San Juan de los Llanos"];
      document.getElementById('noyo').textContent = resumen.destinos.Noyowee;
      document.getElementById('e0324').textContent = resumen.destinos["Estación 0324"];
      document.getElementById('bajos').textContent = resumen.destinos["Bajos del Ejido"];
      document.getElementById('sla').textContent = resumen.destinos["San Luis Acatlán"];
      document.getElementById('totalKm').textContent = totalKm;
    }

    function renderTabla() {
      const tbody = document.querySelector('#tablaViajes tbody');
      tbody.innerHTML = '';

      const viajesOrdenados = [...viajes].sort((a, b) => {
        const mesA = obtenerNumeroMes(a.mes);
        const mesB = obtenerNumeroMes(b.mes);
        const diaA = parseInt(a.dia);
        const diaB = parseInt(b.dia);
        if (mesA !== mesB) return mesA - mesB;
        if (diaA !== diaB) return diaA - diaB;
        return a.turno === "Turno 1" ? -1 : 1;
      });

      viajesOrdenados.forEach((v, i) => {
        let claseProducto = v.producto === 'Premium' ? 'producto-premium' :
                            v.producto === 'Magna' ? 'producto-magna' : 'producto-diesel';

        let claseTurno = v.turno === 'Turno 1' ? 'turno-dia' : 'turno-noche';

        const fila = '<tr>' +
          '<td class="' + claseTurno + '">' + v.dia + '</td>' +
          '<td>' + v.mes + '</td>' +
          '<td>' + v.destino + '</td>' +
          '<td class="' + claseProducto + '">' + v.producto + '</td>' +
          '<td>' +
            '<button onclick="editarViaje(' + i + ')">Editar</button>' +
            '<button onclick="borrarViaje(' + i + ')">Borrar</button>' +
          '</td>' +
        '</tr>';
        tbody.innerHTML += fila;
      });
    }

    function agregarViaje() {
      const dia = document.getElementById('dia').value;
      const mes = document.getElementById('mes').value;
      const destino = document.getElementById('destino').value;
      const producto = document.getElementById('producto').value;
      const turno = document.getElementById('turno').value;
      if (!dia || !mes || !destino || !producto || !turno) return alert('Completa todos los campos.');
      viajes.push({ dia, mes, destino, producto, turno });
      guardarDatos();
      actualizarResumen();
      renderTabla();
    }

    function editarViaje(index) {
      const viaje = viajes[index];
      document.getElementById('dia').value = viaje.dia;
      document.getElementById('mes').value = viaje.mes;
      document.getElementById('destino').value = viaje.destino;
      document.getElementById('producto').value = viaje.producto;
      document.getElementById('turno').value = viaje.turno;
      viajes.splice(index, 1);
      guardarDatos();
      actualizarResumen();
      renderTabla();
    }

    function borrarViaje(index) {
      if (confirm('¿Seguro que quieres eliminar este viaje?')) {
        viajes.splice(index, 1);
        guardarDatos();
        actualizarResumen();
        renderTabla();
      }
    }

    actualizarFecha();
    actualizarResumen();
    renderTabla();
  </script>  <script>
    if ('serviceWorker' in navigator) {
      navigator.serviceWorker.register('sw.js')
        .then(reg => console.log('Service Worker registrado', reg))
        .catch(err => console.log('Error al registrar Service Worker', err));
    }
  </script></body>
</html>